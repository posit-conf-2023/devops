{
  "hash": "701aff5d8a79bb1338eb681fb85f1ee9",
  "result": {
    "markdown": "---\ntitle: \"DevOps for Data Scientists\"\nsubtitle: \"<br>Wifi: Posit Conf 2023 <br>Password: conf2023\"\ntitle-slide-attributes: \n  data-background-color: white\n  data-background-size: contain\nformat:\n  revealjs:\n    theme: night \n    chalkboard: true\n    slide-number: true\n    footer: \"[https://github.com/posit-conf-2023/DevOps](https://github.com/posit-conf-2023/DevOps)\"\n    code-copy: true\n    center-title-slide: false\n    code-link: true\n    code-overflow: wrap\n    highlight-style: a11y\n    width: \"1600\"\n    height: \"900\"\n    execute:\n      echo: true  \n---\n\n\n## Part 1: Introductions, setup, & workshop overview\n\n<br>\n\n<iframe src=\"https://giphy.com/embed/xT5LMqaomxCIqZcYEM\" width=\"480\" height=\"366\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n## Meet your instructors\n\n::: panel-tabset\n## Rika\n\n![](images/rika_bio-01.jpeg){width=\"25%\"}\n\n-   Solutions Engineer at Posit\n\n-   Former Data Scientist and Data Engineer\n\n## Andrie\n\n![](images/Andrie%20square%20500px.jpg){width=\"308\"}\n\n-   Director of Posit Strategy, former Solutions Engineer\n\n## David\n\n![](images/edavidaja.jpeg){width=\"25%\"}\n\n-   David Aja is a Solutions Engineer at Posit. Before joining Posit, he worked as a data scientist in the public sector.\n\n## Gagan\n\n![](images/gagan.png){width=\"27%\"}\n\n-   Gagandeep Singh is a former software engineer and data scientist who has worked in a variety of cross-technology teams before joining Posit as a Solutions Engineer.\n\n## Michael\n\n![](images/michaelmayer-scaled.jpg){width=\"260\"}\n\n-   Scientist by training turned IT / HPC / Scientific Computing\n:::\n\n## Solutions Engineering at Posit\n\n![](images/sol-eng.png){width=\"25%\"}\n\n-   Posit's Solutions Engineering team aims to shrink the distance between the needs of Posit's customers and our Pro and Open Source offerings, leading with curiosity and technical excellence.\n\n-   Our customer-facing work helps our customers deploy, install, configure, and use our Pro products.\n\n## Special Thanks to Alex Gold!\n\n![](images/_40A8864.jpg){width=\"278\" height=\"192\"}\n\nAuthor of [DevOps for Data Science](www.do4ds.com)\n\nPosit Solutions Engineering Team Director\n\n## Introduce yourself to your neighbor\n\n<br>\n\nTake 5 minutes and introduce yourself to your neighbors.\n\n<br>\n\n<iframe src=\"https://giphy.com/embed/Cmr1OMJ2FN0B2\" width=\"480\" height=\"480\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n## Word Cloud\n\n![](images/Screenshot%202023-09-13%20at%201.49.45%20PM.png)\n\n## üíª If your WIFI isn't working let us know as soon as possible!\n\n<br>\n\nName: Posit Conf 2023\n\nPassword: `conf2023`\n\n## Pre-workshop Install\n\n<br>\n\n**Required**:\\\n<https://registry.hub.docker.com/signup>\\\n<https://github.com/signup>\\\n\n<br>\n\n**Optional: (for local development)**\\\n<https://docs.docker.com/desktop/>\\\n<https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>\\\n<https://quarto.org/docs/get-started/>\\\n<https://posit.co/downloads/>\n\n## Workshop Install\n\n<br>\n\n+---------------------------+--------------------------------------+---------------------------------+\n| Software                  | Link                                 | Credentials                     |\n+===========================+======================================+=================================+\n| Posit Workbench & Connect | <http://pos.it/class>                | Classroom ID: `devops_workshop` |\n+---------------------------+--------------------------------------+---------------------------------+\n| Docker Classroom          | <https://labs.play-with-docker.com/> | Docker Hub credentials          |\n+---------------------------+--------------------------------------+---------------------------------+\n\n## Documentation & Communication\n\n<br>\n\nAll documents including **slides** are available on our website: <https://posit-conf-2023.github.io/DevOps/>\n\nDiscord channel - `devops-for-data-scientists`\n\n<br>\n\nDuring labs and exercises,please place a post-it note on the back of your laptop for:\n\nüü• - I need help\n\nüü© - I'm done\n\n## Daily Schedule\n\n<br>\n\nüìÖ September 17 and 18, 2023\n\n‚è∞ 09:00am - 5:00pm\n\n<br>\n\n| Time            | Topic |\n|-----------------|-------|\n| 10:30 - 11:00am | Break |\n| 12:30 - 1:30pm  | Lunch |\n| 3:00 - 3:30pm   | Break |\n\n## Code of Conduct\n\n-   Everyone who comes to learn and enjoy the experience should feel welcome at posit::conf. Posit is committed to providing a professional, friendly and safe environment for all participants at its events, regardless of gender, sexual orientation, disability, race, ethnicity, religion, national origin or other protected class.\n\n-   This code of conduct outlines the expectations for all participants, including attendees, sponsors, speakers, vendors, media, exhibitors, and volunteers. Posit will actively enforce this code of conduct throughout posit::conf.\n\n::: {style=\"text-align: center; font-size: 200%; color: #EE6331\"}\nhttps://posit.co/code-of-conduct/\n:::\n\n## Workshop Goals\n\n-   To understand how DevOps can help you in your work as data scientists\n\n-   To understand the main principles and tools of DevOps\n\n-   To get hands-on experience putting code into production using common DevOps workflows\n\n-   To leave the workshop with some \"assets\" and skills you can use in your work\n\n## Agenda & Lab Overview {.scrollable}\n\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Section/Time                       | Topics                                               | Labs                                                                                                                                                          |\n+====================================+======================================================+===============================================================================================================================================================+\n| Part 1                             | Workshop overview                                    | Infrastructure & wifi setup                                                                                                                                   |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Logistics & setup                                    |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Introductions                                        |                                                                                                                                                               |\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Part 2: DevOps Principles & Tools  | Introduction to DevOps                               | Lab 1: Deploy your own Quarto website on Github Pages & Posit Connect using GitHub Actions \\|                                                                 |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Version control & github                             |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | CI/CD                                                |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Reproducing workflows and environments               |                                                                                                                                                               |\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Part 3: Docker for Data Scientists | How and why data scientists use docker in production | Lab #2: Write your own Dockerfile to deploy Open Source Shiny Server on [Docker playground](https://labs.play-with-docker.com/) and host an app on the server |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Docker: overview and architecture                    |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Building docker images and containers                |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Ports & networking                                   |                                                                                                                                                               |\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Part 4: Data Science in Production | Choosing your deployment method                      | Lab #3: Host and secure an API on Posit Connect                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | APIs and when to use them                            |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Just enough auth                                     |                                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Logging & metrics & testing                          |                                                                                                                                                               |\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Part 5: Discussion                 | Course feedback                                      | Workshop Survey                                                                                                                                               |\n|                                    |                                                      |                                                                                                                                                               |\n|                                    | Questions for the team                               |                                                                                                                                                               |\n+------------------------------------+------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n## Most important Linux commands {.smaller}\n\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| Command  | Description                                                                                                                                                                                                                                                                                                                                                                                | Examples                                                                             |\n+==========+============================================================================================================================================================================================================================================================================================================================================================================================+======================================================================================+\n| *cd*     | change directory                                                                                                                                                                                                                                                                                                                                                                           | https://linuxize.com/post/linux-cd-command/                                          |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *ls*     | list all files in current working directory;                                                                                                                                                                                                                                                                                                                                               | https://linuxize.com/post/how-to-list-files-in-linux-using-the-ls-command/           |\n|          |                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                      |\n|          | add *-lha* flag for hidden files                                                                                                                                                                                                                                                                                                                                                           |                                                                                      |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *pwd*    | print working directory                                                                                                                                                                                                                                                                                                                                                                    | https://linuxize.com/post/current-working-directory/                                 |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *touch*  | create a file                                                                                                                                                                                                                                                                                                                                                                              | https://linuxize.com/post/linux-touch-command/                                       |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *mkdir*  | create a directory                                                                                                                                                                                                                                                                                                                                                                         | https://linuxize.com/post/how-to-create-directories-in-linux-with-the-mkdir-command/ |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *vim*    | open a file in Vim text editor                                                                                                                                                                                                                                                                                                                                                             | https://linuxize.com/post/how-to-save-file-in-vim-quit-editor/                       |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *curl*   | command-line utility for transferring data from or to a server. Uses one of the supported protocols including HTTP, HTTPS, [SCP](https://linuxize.com/post/how-to-use-scp-command-to-securely-transfer-files/) , [SFTP](https://linuxize.com/post/how-to-use-linux-sftp-command-to-transfer-files/) , and [FTP](https://linuxize.com/post/how-to-use-linux-ftp-command-to-transfer-files/) | https://linuxize.com/post/curl-command-examples/                                     |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *echo*   | print argument to standard output                                                                                                                                                                                                                                                                                                                                                          | https://linuxize.com/post/echo-command-in-linux-with-examples/                       |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n| *\\$PATH* | environmental variable that includes colon-delimited list of directories where the shell searches for executable files                                                                                                                                                                                                                                                                     | https://linuxize.com/post/how-to-add-directory-to-path-in-linux/                     |\n+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+\n\n## What we won't cover\n\n<iframe src=\"https://giphy.com/embed/26xBziMPJcCmBbpVm\" width=\"300\" height=\"300\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n-   How to become a DevOps engineer\n\n-   Python-based workflows\n\n-   In-depth security and auth practices\n\n## Part 2: DevOps Principles & Tools\n\n<br>\n\n<iframe src=\"https://giphy.com/embed/l0G18BkChcRRctMZ2\" width=\"480\" height=\"362\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n\n## Section Goals\n\n<br>\n\n-   To understand the main **principles** of DevOps and how they can improve data science workflows.\n\n-   To get familiar with the DevOps **toolkit**.\n\n-   To get familiar with how the **`renv`** package helps create reproducible environments for your R projects.\n\n-   To get comfortable using the terminal for interacting with **git and github**.\n\n-   To understand how to **authenticate** to github using SSH or HTTPS.\n\n-   To practice creating a **CI/CD** workflow using yaml and Github Actions.\n\n## \n\n::: {style=\"text-align: center; font-size: 200%; color: #EE6331\"}\n\"DevOps is a set of cultural norms, practices, and supporting tooling to help make the process of developing and deploying software smoother and lower risk.\"\n:::\n\n::: footer\nDefinition credit:Alex Gold, https://www.do4ds.com\n:::\n\n::: notes\nLet's get into it. We're at a DevOps workshop - so what is it. This is a best effort attempt by our very own Alex Gold, but its still a squishy broad buzz word that's defined differently across organization. Let's discuss how the concept of devops came about.\n:::\n\n## But first...a very brief history lesson\n\n![](images/Untitled%20presentation.png)\n\n::: notes\nReason for squishy definition is because it developed organically in the 2007-2009, across social media, twitter tag #devops was popular, online communities and became more organized through conferences, workshops, and grassroots attempts at implementation at diff companies. Then was introduced into larger companies like Intel, PayPal, Facebook.\n\nBecame more popular through work by Gene Kim and Patrick Debois and others - Pheonix Project is actually a novel about an IT project at a made-up company.\n\nSo what were all these people trying to do - what was the context? All trying to create something.\n:::\n\n## So you want to create an app?\n\n![](images/mobius.png){width=\"800\"}\n\n::: notes\nLet's talk about what it looks like to create an application. On one side you had developers creating some sort of application - let's say a stock trading application, so your end user are stock traders\n\nDevs would work on creating the code for this app, get requirements, test it and then package up all the source code in some way so that its executable and that it could be deployed somehow to those end users you'd configure the server, install any tools and frameworks needed to run the code, and then launch.\n\nNow your stock traders are using their application - maybe they're giving feedback somehow or errors are being logged. Another team is monitoring the environment and seeing if servers are able to handle the load of all the users.\n\nBut eventually you'd need to fix bugs or release new features or maybe change things so that the app could handle more end users -\n\nyour dev team make updates, version those changes, test them, re-launch the app and you do this over and over again in some sort or release process -- so you have this continuous cycle of releasing your app, finding something to fix or add, testing that change, integrating that code, and then releasing the app..\n\nMaking this continuous process as fast, efficient, accurate, and low risk is the goal of devops.\n\nsounds pretty efficient right -\n:::\n\n## Problems DevOps tries to solve\n\n<br>\n\n![](images/PROBLEMS.png)\n\n::: notes\nSo this is the idealized example - but what was it like in practice 20 years ago. You want to make the release process as fast as possible but you also want it to be tested and free of bugs. And this introduces a natural conflict between speed and stability\n\nYou have the same goals of speed and accuracy - but this process of continuous integration, of testing, of automating processes so that your users can get their hands on the app - didnt exist.\n\nOne problem is that the entire process is siloed between the creation of the code and the deployment of your app. So your developers finish their code and then throw it over the fence to ops. Maybe they then throw it to security or to QA. But there was no formal alliance in place or processes on how the teams work together. Because each team is seemingly working on one part - the code vs. the deploy - there's also technical knowledge siloes - each team only knows their bit but not anything else.\n\nSo imagine this stock trading app - your developers are creating cool new features so that you can easily buy and sell stock, maybe even see data on whats happening in the market. But they're not necessarily thinking about how the app is secured or if its compliant with federal regulations or if user data is protected. Obvi this is a worst case scenario - but you get the picture.\n\nSo as the app is built it keeps getting thrown back and forth between the two teams and leads to one of the major problems that devops is trying to fix - really slow and manual bureaucratic release process.\n\nOn the technical side, a lot of the actual work is done manually. So you can imagine one team running tests manually in one environment - maybe the environment itself is created manually, or someone manually sizing up or fixing a server. This takes time, you need to get approval from people, and its not easily reproduced or really documented anywhere. Also, there is a lot of room for error and if things break its not easy to roll back bugs.\n\nProblem becomes how do you automate this release process, make it streamlined, less error prone, improve how all these teams integrate and operate, and at the end of the day make the process of getting the app into the hands of your users much faster.\n:::\n\n## Common DevOps Principles\n\n<br>\n\n<br>\n\nü§≤ Collaboration\n\n<br>\n\nüöö Continuous Integration & Delivery\n\n<br>\n\nü§ñ Automation\n\n<br>\n\nüìî Reproducibility\n\n<br>\n\nüë®‚Äçüé§ Culture change\n\n::: notes\nAs the field of devops developed, there are different implementations/diff technologies of what devops means - these happen differently at different companies But there have been some common philosophies and best practices that have come out that I've seen consistently across the entire ecosystem.\n\nFirst - **everyone** that's involved in the creation of this application should be collaborating and working together. This is my wink wink moment for you all of why devops is so important for data scientists\n\nThen we have this concept of **Continuous Integration & Delivery** - we'll take about this in greater length in a few minutes - but this is the process of 1. the coding of the app 2. the versioning of that code is some kind of repository 3. testing those changes 4. integrating them into the app if those tests are passed 5. And then that continuous process of releasing those changes into production\n\nSo for the CI/CD process to work and specifically to work quickly - we will need some level of **automation** as we move through that cyclical process. You don't want to have to pause things to get approval or manually change things when tests pass - you want it to get to the user as quickly as possible after everything has been tested.\n\nThe next piece is **reproducibility**. You have different teams working on different pieces of the puzzle, but at the end of the day the end result is the same. Everyone is working on that same app - in this case our stock platform. So as jobs go from one team to another team and as your app goes from development to testing to finally your users, you want to make sure that there's a common ecoystem that everyone is working in. When you're testing your app you want to make sure that your environment is as similar to what is going to be in real-life or what is called \"production\". You also want to make sure that your code itself is reproducible and that it works for users regardless of their location or their computer or their browser maybe.\n\nThe last piece that I find really interesting is the concept of **culture change**. So what needs to change in your organization so that you're able to function while still holding this tension or conflict between speed and stability. How do you make sure that teams that have different incentives - for example security team vs. a data team - are able to work together.\n\nSo let me pause - that's a lot - everyone got a bit of a history lesson but as far as i'm aware no one here is a software developer or an IT engineer. So that brings me to this very important question: But\n:::\n\n## Why should we as data scientists care about this? {style=\"text-align: center; font-size: 200%; color: #EE6331\"}\n\n::: notes\nlets have a little thought experiment\n:::\n\n## Has this ever happened to you?\n\n::: columns\n::: {.column width=\"50%\"}\n[You come back to code from a year ago and now it doesnt run!]{.fragment fragment-index=\"1\"}\n:::\n\n::: {.column width=\"50%\"}\n[Reproducibility]{.fragment fragment-index=\"2\" style=\"color: orange;\"}\n:::\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n[You need to hand off your model to the Engineering team but they only code in Java]{.fragment fragment-index=\"3\"}\n:::\n\n::: {.column width=\"50%\"}\n[Continuous Integration & Delivery & Collaboration]{.fragment fragment-index=\"4\" style=\"color: orange;\"}\n:::\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n[Your boss asks you to share that Shiny app with a client but the ops team is too busy working on their roadmap to help you deploy it somewhere.]{.fragment fragment-index=\"5\"}\n:::\n\n::: {.column width=\"50%\"}\n[Culture Change]{.fragment fragment-index=\"6\" style=\"color: orange;\"}\n:::\n:::\n\n## We should care because ...\n\n<br>\n\n::: incremental\n-   Data scientists are developers!\n-   Data science careers have moved from academic sphere to tech and software but education hasnt always followed\n-   Automation, collaboration, testing can dramatically improve data work and improve reproducibility\n-   The many hats of a data scientist\n-   Improve collaboration & communication with other teams\n:::\n\n::: notes\nspent a lot of time talking about teams working together to create a shared product. Data scientists are a part of that team. DS is a relatively new field and creating data-intensive apps is a huge part of tech world today.\n\nDS career paths started in academia - not a lot of best practices are taught\n:::\n\n## Responsibility of the analyst\n\n![](images/replic_crisis.png)\n\n::: notes\nI mentioned before that a lot of DS comes from academia and research. So the concept of reproducing your results - especially if those results play a role in how medicines or medical devices are developed - is incredibly important.\n\n2005 essay by John Ioannidis in scientific journal on what is known as the replicability crisis in scientific publishing, arguing that majority medical research studies cannot be replicated.\n\nSo as data scientists and we are curators of the data and are responsible for its legitimacy in many ways - obv cant always control it of course.\n\nThis second paper started looking a method of reproducing results - namely Jupyter notebooks - and found a lot of ways that reproducibility was improved but also a lot of places where things could have been done better and some best practices for how to do that - in what we call literate programming.\n\n**27,271** Notebooks:\n\n-   **11,454** could not declare dependencies\n\n-   **5,429** could not successfully install declared dependencies\n\n-   **9,185** returned an error when ran\n\n-   **324** returned a different result than originally reported\n\nLet's get back to our principles:\n:::\n\n## The Devops Process Flow\n\n![](images/Concept%20Map.jpg){width=\"690\"}\n\n## Proliferation of tools\n\n![](images/ecosystem.png)\n\n::: notes\nproliferation of tools, source code management, repo management, build tools, data management, deployment, container services, config management, monitoring, cloud services\n:::\n\n## An opinionated take on tools\n\n<br>\n\n-   CI/CD\n-   Environment Management\n-   Version Control & Git workflows\n-   Package Management\n-   Automation & Build tools\n-   Continuous Monitoring and Logging\n\n::: notes\n-these are the ones that we're going to be covering - lot of tools, but this is what they should help you to do -definitely not going to be a complete overview of the entire ecosystem - there's also a lot of overlap in the definitions -\\\n-but in my opinion the most important tool types to get you started quickly.\n:::\n\n## The CI/CD Pipeline\n\n![](images/cicd2.png)\n\n::: notes\n-   As we discussed before CI/CD is an iterative cycle of small steps to quickly build, test, and deploy your code - this is a critical component of devops.\n\n-   So CI/CD is often said in the same breath - as it makes up a continuous pipeline - but its actually pretty discrete parts so I want to make sure we understand how they differ.\n\n-Continuous integration (CI) - this is where you or anyone who writes code, automatically builds, tests, and commits code changes into a shared repository; This is usually triggered by an automatic process where the code is built, tested and then either passes or fails. This step is focused on improving the actual build or application as quickly as possible.\n\nDifferent types of tests - from unit tests to integration tests to regression tests.\n\n-Continuous delivery (CD) and deployment are less focused on the build but on the actual installation and distribution of your build. This includes an automated process to deploy across different environments - from development to testing and finally to production. Delivery is the process for the final release - that \"push of a button step\" to get to prod.\n\nwe'll talk about some examples of popular CI/CD tools in a bit - Github Actions, Jenkins, CircleCI, Gitlab CI\n:::\n\n## Environment Management {.smaller}\n\n<br>\n\n+---------------------------------+-------------------------------------------------------------+------------------------------+\n| Development                     | Testing                                                     | Production                   |\n+=================================+=============================================================+==============================+\n| -   Exploratory                 | -   as similar to prod as possible                          | -   automatic CD             |\n|                                 |                                                             |                              |\n| -   Often local machine         | -   unit & integration testing                              | -   isolated from dev & test |\n|                                 |                                                             |                              |\n| -   Access to R/Python Packages | -   data validation                                         | -   created with code        |\n|                                 |                                                             |                              |\n|                                 | -   \"sandbox\" with data that's as close to real as possible |                              |\n+---------------------------------+-------------------------------------------------------------+------------------------------+\n\n::: notes\nunit test - testing individual units of code to make sure it does what you want it to do\n\nintegration test - make sure putting pieces together doesnt introduce any errors\n\nwant to be able to reproduce the environments as closely as possible\n:::\n\n## Version Control & Workflows\n\n![](images/versioncontrol.png)\n\n::: notes\nVersion control is a main tool for Continuous Integration -\n\nlots of variants - git, github., svn, gitlab, etc\n\ndistributed version control - everyone has their own repo\n\ncan track changes and roll them back\n\ncan fix merge conflicts\n\nan an iterative process to build, test, collaborate on your code to above environments. Very commonly, individuals work on separate branches that are then tested and reviewed by colleagues before they are merged into a main branch.\n\nIn addition to the action of promoting your code - its also important to have processes in place for how the code integration process occurs - includes humans coming together and making some decisions -\n\ne.g code reviews, process for your team, how to name things, pull requests, merging, feature branching, automatic tests\n:::\n\n## Lab Activity - developing locally using Quarto\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\nLogin to [pos.it/class](pos.it/class) with code `devops_workshop`\n\n[Lab 1 Part 1](https://posit-conf-2023.github.io/devops/coursework_labs/01_lab_devops_CICD/Deploy_Quarto_GHA.html#part-1-create-a-local-quarto-website)\n\n::: notes\nShow how to login to the workshop environment and where the lab is\n\n5 minutes\n:::\n\n## Is version control secure?\n\n<br> <iframe src=\"https://giphy.com/embed/l2JdZzcXF8hqpPMpW\" width=\"480\" height=\"366\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe>\n\n## A short auth teaser\n\n-   We can use a variety of data sharing \"transfer protocols\"\n-   Protocols specify what kind of traffic is moving between 2 machines\n-   Use different security mechanisms\n-   Ports on the host and destination specifies where to direct the traffic\n\n<br>\n\n**HTTPS**\n\n![](images/Screenshot%202023-09-07%20at%209.28.32%20AM.png)\n\n::: notes\nAdd diagram - http and https two computers with ports\n\nThere are lots of diff transfer protocols; what you use depends on what kind data is being transferred and your security requirements. So for example, maybe you're sending plain text or email or a webpage.\n\nProtocols as well as processes or application run on specific ports. A port is a virtual point where network connections start and end. Allow computers to easily differentiate between different kinds of traffic. So for example, Shiny Server runs on port 3838, Workbench runs on 8787\n\nwhether its email, text, files, etc Ports are software-based and managed by a computer's operating system. Ports emails go to a different port than webpages, for instance, even though both reach a computer over the same Internet connection.\n:::\n\n## Git protocol options\n\n![](images/http-vs-https.png)\n\n::: notes\nhttp - 80\n\nhttps - 443\n\nssh - 22\n\nwe'll be using https - because ... from jenny bryans happy git with R\n\nI find HTTPS easier to get working quickly and **strongly recommend** it when you first start working with Git/GitHub.\n\nHTTPS is what GitHub recommends, presumably for exactly the same reasons.\n\nThe \"ease of use\" argument in favor of HTTPS is especially true for Windows users.\n\nAnother advantage of HTTPS is that the PAT we'll set up for that can also be used with GitHub's REST API.\n\nhypertext transfer protocol When a web user wants to load or interact with a web page, their web browser sends an HTTP request to the origin server that hosts the website's files. These requests are essentially lines of text that are sent via the internet.\n\nhttps : http encrypted with SSL/TLS - digital certificates that establish an encrypted connected\n\nSSH: secure shell, public-key cryptography to authenticate the client, used for remote logins, command line execution\n\nHTTPS is simpler. For most services besides Github, you just have to enter in your username and password, and you'll be able to push and pull code.\n\nYou don't have to juggle multiple SSH keys around to use multiple devices.\n\nPort 443, which HTTPS uses, is open in basically any firewall that can access the internet. That isn't always the case for SSH.\n\nThe primary downside for most people is that you must enter your Git password/token every time you push. While it gets added to a cache, it's not configured to cache permanently (though this can be changed). With SSH keys, it just uses the key file on disk every time.\n\nWhere SSH takes the lead is with the authentication factor---the key. The length of it alone makes it harder to accidentally leak, and due to it being unwieldy and unique, it's generally more secure.\n:::\n\n## Reproducing your environment\n\n<br>\n\nWhat are the layers that need to be reproduced across your dev, test, and prod environments?\n\n<br>\n\nWhat's your most difficult reproducibility challenge?\n\n## Layers of reproducibility\n\n![](images/Screenshot%202023-09-13%20at%208.23.56%20PM.png)\n\n::: notes\n-   code - scripts, configs, applications\n-   Packages\n-   System - r and python depend on underlying system software - for example, spatial analysis packages, or anything that requires Java - rJava\n-   OS\n-   Hardware - processors Intel chip, silicon chip\n:::\n\n## Packages vs. Libraries vs. Repositories\n\n<br>\n\n**Package** - contains code, functions, data, and documentation.\n\n<br>\n\n**Library** - is a directory where packages are installed.\n\n<br>\n\n**Repository** - a collection of packages. CRAN is a public external repository that is a network of servers that distribute R along with R packages.\n\n::: notes\npackages - Can be be distributed as SOURCE (a directory with all package components), [BINARIES](https://solutions.posit.co/envs-pkgs/environments/repositories/index.html#binary-packages) (contains files in OS-specific format) or as a BUNDLE (compressed file containing package components, similar to source).\n\nlibrary - You can have user-level or project-level libraries. Run `.libPaths()` to see yours. To use a package in has to be installed in a library with `install.packages()` and then loaded into memory with `library(x)` .\n\nrepo - others include pypi, bioconducter, private repos\n:::\n\n## `renv` workflow\n\n![](images/Screenshot%202023-09-06%20at%208.31.22%20PM.png)\n\n::: notes\n1.  Use a version control system e.g.[git](https://git-scm.com/) with [GitHub](https://github.com/)\n\n2.  One user (should explicitly initialize `renv` in the project, This will create the initial `renv` lockfile, and also write the `renv` auto-loaders to the project's `.Rprofile` and `renv/activate.R`. These will ensure the right version of `renv` is downloaded and installed for your collaborators when they start in this project.\n\n3.  push your code alongside the generated lockfile `renv.lock`. Be sure to also share the generated auto-loaders in `.Rprofile` and `renv/activate.R`.\n\n4.  After this has completed, they can then use [`renv::restore()`](https://rstudio.github.io/renv/reference/restore.html) to restore the project library locally on their machine.\n:::\n\n## Example - renv\n\n::: {style=\"font-size: 100%\"}\n``` {eval=\"FALSE\"}\n# install.packages(\"renv\")\nrenv::init()\nrenv::snapshot()\nlapply(.libPaths(), list.files)\n```\n:::\n\n::: footer\nüîç Live code\n:::\n\n## Lab Activity - `renv` workflow & github authentication\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 1: Part 2 & 3](https://posit-conf-2023.github.io/devops/coursework_labs/01_lab_devops_CICD/Deploy_Quarto_GHA.html#part-2-renv-workflow)\n\n::: notes\nYou'll be doing renv in your workbench environment both in your console for r code and in the terminal for git commands you'll also need to log in to your github account where you'll be creating an upstream repository to link with your local code.\n\nwe'll be using https auth but there's also information if you later want to test out ssh\n\n10-15 minutes\n:::\n\n## Build tools\n\n-   Virtualization/Containerization\n\n-   Infrastructure as code\n\n-   Automation with Github Actions/Jenkins/CircleCI\n\n-   Cloud devops tools (Azure Devops, Google Cloud Build)\n\n::: notes\n-   automate common build and deployment tasks\n-   for example, generating artifacts, deploying to diff environs, provisioning or deprovisioning environments -\n-   some overlap here between these tools and CI/CD\n\nVirtual/Container -prod-identical - help you build isolated environments and tested and debug code; docker, kubernetes, other container services\n\nIaC - quickly re-provision your entire environment with code (chef, puppet, dockr, terraform, ansible) instead of fixing it, just tear it down and restart it - configuration management\n\ntools that automate the process of building and deploying your code once it goes from your dev env to test and prod\n\ncloud devops - run your entire devops stack in a cloud managed cloud managed platform\n\nYou also have support tools - that are used across a lot of these tools - I want to discuss one of them here - YAML\n:::\n\n::: footer\nIllustration credit:\n:::\n\n## Power of YAML\n\n-   YAML Ain't Markup Language\n\n-   communication of data between people and computers\n\n-   human friendly\n\n-   configures files across many execution environments\n\n## YAML\n\n```         \nEmpRecord:  \n  emp01:\n    name: Michael\n    job: Manager\n    skills: \n      - Improv\n      - Public speaking\n      - People management\n  emp02:\n    name: Dwight\n    job: Assistant to the Manager\n    skills: \n      - Martial Arts\n      - Beets\n      - Sales\n```\n\n-   whitespace indentation denotes structure & hierarchy\n\n-   Colons separate keys and their values\n\n-   Dashes are used to denote a list\n\n## Example - YAML in action\n\n-   Docker compose [yaml file](https://github.com/rstudio/rstudio-docker-products/blob/dev/docker-compose.yml) to spin up all 3 Posit Pro products\n\n::: footer\nüîç Live code\n:::\n\n## Exercise - Inspect your YAML\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\nInspect your \\_quarto.yml file and identify what each part of it does using the quarto site.\n\n::: notes\n2-5 minutes - render your site to help\n:::\n\n## Continuous Integration Example\n\n![](images/Untitled%20(2).jpg)\n\n::: notes\ntoday - we'll be discussing GHA Actions - which is a common CI tool that is handy because it uses the same platform as your versioned repositories - inthis case github\n\nuses yaml as a configuration tool\n:::\n\n## Other GHA Categories\n\n-   Deployment\n\n-   Security\n\n-   Continuous Integration\n\n-   Automation\n\n-   Pages\n\n-   Make your own!\n\n[Examples](https://github.com/Rikagx/ssh_testing/actions/new)\n\n## Quarto Publish Flows\n\n### Manually\n\n![](images/Untitled.jpg){width=\"400\"}\n\n### Continuous Integration\n\n![](images/Untitled%20(1).jpg)\n\n::: notes\ncan publish to quarto pub, GHP, connect, netlify, confluence, other destinations, more work to set up\n:::\n\n## GHA Structure\n\n![](images/Screenshot%202023-09-10%20at%201.32.42%20PM.png)\n\n**Open source ecosystem of available actions**\n\n-   [Github Official Actions](https://www.github.com/actions)\n\n-   [RLib Actions](https://www.github.com/r-lib/actions)\n\n::: notes\nWorkflows can include tests, markdown renders, shell scripts, cron jobs, or deployments. They can be as simple or as complicated as you need. Open-source community provides a ton of examples of actions.\n:::\n\n## Actions Syntax\n\n[Code](https://posit-conf-2023.github.io/devops/coursework_labs/01_lab_devops_CICD/Deploy_Quarto_GHA.html#part-4-publish-using-gha)\n\n## Lab Activity - CICD with Github Actions\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 1: Part 4](https://posit-conf-2023.github.io/devops/coursework_labs/01_lab_devops_CICD/Deploy_Quarto_GHA.html#part-4-publish-using-gha)\n\n::: notes\nwe'll be doing a few things - create a gh branch - publish to github - create a gha with a yaml file - create an api key for connect - update yaml file - push everything\n:::\n\n## Logging\n\n<br>\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell filename='app.py'}\n\n```{.python .cell-code}\nimport logging\n\n# Configure the log object\nlogging.basicConfig(\n    format='%(asctime)s - %(message)s',\n    level=logging.INFO\n)\n\n# Log app start\nlogging.info(\"App Started\")\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell filename='app.R'}\n\n```{.r .cell-code}\n# Configure the log object\nlog <- log4r::logger()\n\n# Log app start\nlog4r::info(log, \"App Started\")\n```\n:::\n\n:::\n:::\n\n::: notes\ncreate a log session for your r or python code, write a log statement, gets added into an entry\n\nwhat to log\n\ntypes of logs\n:::\n\n## Monitoring\n\n![](images/icons8-prometheus-48.png){width=\"100\"}\n\n**Prometheus**\n\n-   OS monitoring toolkit\n\n-   official [Prometheus client](https://github.com/prometheus/client_python) in Python\n\n-   `{openmetrics}` package to register metrics from a Plumber API or Shiny app.\n\n![](images/icons8-grafana-48.png){width=\"100\"}\n\n**Grafana**\n\n-   GUI for Prometheus\n\n-   [Get Started with Grafana and Prometheus](https://grafana.com/docs/grafana/latest/getting-started/get-started-grafana-prometheus/)\n\n## Part 3: Docker for Data Scientists\n\n<br> <iframe src=\"https://giphy.com/embed/3orifbpd7ODPyeW5sk\" width=\"480\" height=\"366\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe>\n\n## Section Goals\n\n-   to understand different docker workflows\n-   to learn common docker syntax for building and running containers\n-   to get hands on experience building and running containers\n-   to explore the linux file system\n\n## Why use a container at all?\n\n-   allows you to package up everything you need to reproduce an environment/application\n-   lightweight system without much overhead\n-   share containers with colleagues without requiring them to have to set up their own local machines\n-   quick testing and debugging\n-   allows you to easily version snapshots of your work\n-   scaling up\n\n## Our Docker Environment\n\n![](images/Screenshot%202023-09-15%20at%2011.56.18%20AM.png)\n\n## Workflow\n\n![](images/Screenshot%202023-09-15%20at%2012.58.53%20PM.png){width=\"800\"}\n\n::: notes\ndockerfile - is a script of instructions for how to build an image\n\nimage - everything you need to run an application - all the layers that build the environment, dependencies, libraries, files\n\ncontainer - isolated instance of a running image. you can create, stop, start, restart, containers. When a container is removed/deleted any changes to its state that arent stored in some kind of persistent storage disappear. Called ephemeral container - Think of a container as a snapshot in time of a particular application.\n\nMissing piece - repository - for images, like dockerhub, container registry cloud services, private registries\n\nBuild - Run - Push\n:::\n\n## Architecture\n\n![](images/Screenshot%202023-08-30%20at%2010.12.11%20AM-01.png){width=\"800\"}\n\n::: notes\nOn the left we have the client - think of this as your computer or perhaps a computer somewhere in the cloud\n\non the right you have the server - this the docker host which runs something called the Docker daemon - you'll be communicating with the Docker daemon via a command line interface.\n\nThe host can be remote or it can be on your computer with the client - so for example, you can download something called Docker Engine. In most cases the host is running on a Linux OS. (in different laptop OS, Docker Desktop uses a lightweight VM under the hood)\n\nDocker engine is a container runtime that runs on different OS's. Sets up the isolated environment for your container.\n\nwhat the heck is the Docker daemon - its a service that does all the heavy lifting of building and running your containers\n\nregistry - upload and download images\n\nDocker Desktop includes the Docker daemon (dockerd), the Docker client (docker), Docker Compose - another client, Docker Content Trust, Kubernetes, and Credential Helper.\n:::\n\n## Images\n\n![](images/Screenshot%202023-09-15%20at%2012.25.29%20PM.png){width=\"800\"}\n\n::: notes\nmade up of individual layers so its really quick to build isolating applications into their own image\n:::\n\n## Dockerhub Registry\n\nhttps://hub.docker.com/search?q=\n\n## Containers\n\n![](images/Screenshot%202023-09-15%20at%2012.14.04%20PM.png){width=\"800\"}\n\n::: notes\nrunnable instance of an image.\n\nFrom the bottom up Containers run on some sort of infrastructure - this could be your laptop or a server somewhere in the cloud\n\nhost OS - shared OS between container instances, dont need a guest os for each one, makes them really light and able to spinup in milliseconds\n\ncontainers are very lightweight which makes it really easy and quick to spin them up\n\nInstead, the Docker daemon communicates directly with the host operating system and knows how to ration out resources for the running Docker containers.\n:::\n\n## How can data scientists use docker? {style=\"text-align: center; font-size: 200%; color: #EE6331\"}\n\n## Example - testing & versioning\n\n<br>\n\n<br>\n\n``` bash\ndocker pull postgres:12\ndocker pull postgres:latest\ndocker image ls -a\ndocker run -d -e POSTGRES_PASSWORD=mysecretpassword --name postgres_early imageID\ndocker run -d -e POSTGRES_PASSWORD=mysecretpassword --name postgres_new imageID\ndocker container ls -a\ndocker stop\ndocker restart\n```\n\n::: footer\nüîç Live code\n:::\n\n::: notes\ncan pull but also if you just run - will put it from hub if doenst find locally Let's see an example of what this looks like in practice. Lets say we need to use a postgres sql database for some testing - but we want to test using an older and a newer version of postgres.\n\ndocker image ls - lets list all the images that we have\n\ndocker pull postgres:12 - see how its pulling and extracting all these layers - but what if we want a newer version or what if we need to run both versions on our machine\n\ndocker pull postgres:latest - notice how some of these layers already exist so it takes a lot less time\n:::\n\n## Example - reproduce environments\n\n<br>\n\nhttps://hub.docker.com/u/rocker\n\n<br>\n\n```         \n# pull the image\ndocker pull rocker/r-base\n\n# run container\ndocker run --rm -it rocker/r-base\n```\n\n## Example - isolate applications\n\n<br>\n\nhttps://hub.docker.com/u/rstudio\n\n<br>\n\n**DO NOT RUN!**\n\n```         \ndocker run -it --privileged \\\n    -p 3939:3939 \\\n    -e RSC_LICENSE=$RSC_LICENSE \\\n    rstudio/rstudio-connect:ubuntu2204\n```\n\n## Example - Docker as deployment strategy\n\n![](images/dep_strategy.png){width=\"800\"}\n\nhttps://github.com/mickwar/ml-deploy\n\n## Example - Docker in CI pipeline\n\n```         \njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      -\n        name: Checkout\n        uses: actions/checkout@v3\n      -\n        name: Login to Docker Hub\n        uses: docker/login-action@v2\n        with:\n          username: ${{ secrets.DOCKERHUB_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_TOKEN }}\n      -\n        name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v2\n      -\n        name: Build and push\n        uses: docker/build-push-action@v4\n        with:\n          context: .\n          file: ./Dockerfile\n          push: true\n          tags: ${{ secrets.DOCKERHUB_USERNAME }}/latest\n```\n\n::: notes\n-   Data scientists benefit from Docker's consistency and reproducibility.\n\n-   Create isolated environments for different experiments.\n\n-   Share work with colleagues without environment setup issues.\n\n-   **Consistency:** Containers ensure that applications run the same way across different environments.\n\n-   **Isolation:** Containers isolate applications and their dependencies, preventing conflicts.\n\n-   **Portability:** Containers can run on any system that supports Docker, reducing \"it works on my machine\" issues.\n:::\n\n## Modes for running containers\n\n+------------------------------------------------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Mode                                                       | Run command       | Use case                                                                                                                                                                                                           |\n+============================================================+===================+====================================================================================================================================================================================================================+\n| Detached                                                   | `docker run -d`   | This runs the container in the **background** so the container keeps running until the application process exits, or you stop the container. Detached mode is often used for production purposes.                  |\n+------------------------------------------------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Interactive + terminal                                     | `docker run -it`  | This runs the container in the **foreground** so you are unable to access the command prompt. Interactive mode is often used for development and testing.                                                          |\n+------------------------------------------------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Remove everything once the container is done with its task | `docker run --rm` | This mode is used on foreground containers that perform **short-term tasks** such as tests or database backups. Once it is removed anything you may have downloaded or created in the container is also destroyed. |\n+------------------------------------------------------------+-------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n## Run Command\n\n![](images/slides%20(1).png)\n\n## Lab Activity - Running containers\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 2: Part 1](https://posit-conf-2023.github.io/devops/coursework_labs/02_lab_docker/Exercises.html#part-1-run-commands)\n\n## Running containers\n\n<br>\n\n```         \ndocker pull ubuntu\ndocker image ls -a\n\ndocker run -it ubuntu bash\nls\nwhoami\nhostname\n# exit the container with Ctrl+D or exit\n\ndocker run -d ubuntu\ndocker container ls -a\n\ndocker run -d -P --name nginx1 nginx:alpine\n\ndocker container stop nginx1\n\ndocker run --rm debian echo \"hello world\"\n```\n\n::: notes\nNginx, pronounced like \"engine-ex\", is an open-source web server that, since its initial success as a web server, is now also used as a reverse proxy, HTTP cache, and load balancer.\n:::\n\n## Container Debugging\n\n<br>\n\n```         \ndocker run -it -d ubuntu\ndocker container ls -a \ndocker exec -it CONTAINER_ID bash\n\ndocker container run -d --name mydb \\\n --name mydb \\\n -e MYSQL_ROOT_PASSWORD=my-secret-pw \\ \n mysql\n \n docker container logs mydb\n```\n\n::: footer\nüîç Live code\n:::\n\n## Lab Activity - Debugging Containers\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 2: Part 2](https://posit-conf-2023.github.io/devops/coursework_labs/02_lab_docker/Exercises.html#part-2-debugging-containers)\n\n## Port Mapping with `docker run -p host:container`\n\n<br>\n\n![](images/port%20mapping.png){width=\"600\"}\n\n<br>\n\n```         \ndocker pull httpd:alpine\ndocker pull httpd:latest\n\ndocker inspect --format='{{.Config.ExposedPorts}}' httpd:latest\ndocker inspect --format='{{.Config.ExposedPorts}}' httpd:alpine\n\ndocker run -p DockerHostPort:ApplicationPort\n\ndocker run -d -p 80:80 --name httpd-latest httpd:latest\ncurl http://localhost:81\n\ndocker run -d -p 6574:80 --name httpd-alpine httpd:alpine\ncurl http://localhost:80\n```\n\n::: footer\nüîç Live code\n:::\n\n## Lab Activity - Mapping ports\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 2: Part 3](https://posit-conf-2023.github.io/devops/coursework_labs/02_lab_docker/Exercises.html#part-3-mapping-ports)\n\n## Persisting data with Docker\n\n<br>\n\n-   State is persistent information that is recorded and recalled later\n\n-   Containers are designed to be ephemeral e.g. stateless by default\n\n-   Data applications are usually stateful and more complex to deploy\n\n::: notes\nImages are made of a set of read-only layers. When we start a new container, Docker adds a read-write layer on the top of the image layers allowing the container to run as though on a standard Linux file system.\n\nSo, any file change inside the container creates a working copy in the read-write layer. However, when the container is stopped or deleted, that read-write layer is lost.\n:::\n\n## Options {.scrollable}\n\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n| Storage Type                | Description                                                 | Use case                                                  |\n+=============================+=============================================================+===========================================================+\n| Volume mount                | create new volume managed by Docker CLI                     | Need to transfer, share, data between multiple containers |\n|                             |                                                             |                                                           |\n|                             | dedicated filesystem on the host (/var/lib/ docker/volumes) |                                                           |\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n| Bind mount                  | use any available host filesystem                           | Access hidden files                                       |\n|                             |                                                             |                                                           |\n|                             | not managed by Docker CLI                                   |                                                           |\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n| tmpfs                       | uses host memory                                            | sensitive data                                            |\n|                             |                                                             |                                                           |\n|                             | not permanent                                               |                                                           |\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n| External Database           | container remains stateless;                                | Production workflow                                       |\n|                             |                                                             |                                                           |\n|                             | container connects to external database                     |                                                           |\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n| External Shared File System | shared network file system int the cloud (NFS)              | Managed or multi-cluster deployments                      |\n|                             |                                                             |                                                           |\n|                             |                                                             | Don't want to limit storage                               |\n+-----------------------------+-------------------------------------------------------------+-----------------------------------------------------------+\n\n## Lab Activity - Persisting Data\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 2: Part 4](https://posit-conf-2023.github.io/devops/coursework_labs/02_lab_docker/Exercises.html#part-4-mounting-data)\n\n## Building Docker Images\n\n<br>\n\nImages are build using a Dockerfile or interactively \"on-the-fly\" for testing\n\n![](images/buildimage-02.png)\n\n## Build Command\n\n![](images/slides%20(1)-01.png)\n\n## Lab Activity - Commit and push container to DockerHub\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 2: Part 5](https://posit-conf-2023.github.io/devops/coursework_labs/02_lab_docker/Exercises.html#part-5-building-images-interactively)\n\n## A few Dockerfile Build Commands\n\n+--------------+-------------------------------------------------------------+\n| Command      | Description                                                 |\n+==============+=============================================================+\n| ARG          | Define variables passed at build time                       |\n+--------------+-------------------------------------------------------------+\n| FROM         | Base image                                                  |\n+--------------+-------------------------------------------------------------+\n| ENV          | Define variable                                             |\n+--------------+-------------------------------------------------------------+\n| COPY         | Add local file or directory                                 |\n+--------------+-------------------------------------------------------------+\n| RUN          | Execute commands during build process                       |\n+--------------+-------------------------------------------------------------+\n| CMD          | Execute command when you run container; once per Dockerfile |\n+--------------+-------------------------------------------------------------+\n| ENTRYPOINT   | Execute command to change default entrypoint at runtime     |\n+--------------+-------------------------------------------------------------+\n| USER         | Set username or ID                                          |\n+--------------+-------------------------------------------------------------+\n| VOLUME       | Mount host machine to container                             |\n+--------------+-------------------------------------------------------------+\n| EXPOSE       | Specify port pn which container listens at runtime          |\n+--------------+-------------------------------------------------------------+\n\n## Dockerfile Example\n\nWalk through Posit Connect [Dockerfile](https://github.com/rstudio/rstudio-docker-products/blob/dev/connect/Dockerfile.ubuntu2204)\n\n## Activity - Putting it all together in Dockerfile\n\nüü• - I need help\n\nüü® - I'm still working\n\nüü© - I'm done\n\nComplete Lab 2: Part 5\n\n## Part 4: Data Science in Production\n\n<br> <iframe src=\"https://giphy.com/embed/4oMoIbIQrvCjm\" width=\"480\" height=\"369\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe>\n\n## Data Science in Production\n\n![](images/layers.png)\n\n## Production \"State\"\n\n<br>\n\nWhat are some questions that we should ask once our code is ready for production?\n\n<br>\n\n-   Where is it deployed?\n\n-   Is it secure and accessible?\n\n-   Does it scale?\n\n-   Is it tested?\n\n## Choosing the right presentation layer\n\n-   [Alex's flow chart](https://do4ds.com/chapters/sec1/1-2-proj-arch.html)\n\n## Choosing a REST API\n\n![](images/what_is_rest_api.png)\n\n::: notes\napplication programming interface clients to communicate with a server. Rest API is a kind of web-service which stores and retrieves necessary data. It provides great flexibility to developers since it does not need any dependent code libraries to access the web-services. Amongst the many protocols supported by REST, the most common one is HTTP. When a request is sent from the client using a HTTPRequest, a corresponding response is sent from the server using HTTPResponse.\n:::\n\n## Lab Activity: Host API on Posit Connect\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 3: Part 1](https://posit-conf-2023.github.io/devops/coursework_labs/03_lab_data_in_prod/lab_solution.html#part-1-host-api-on-posit-connect)\n\n## How is it secured?\n\n## Lab Activity: Explore API structure\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 3: Part 2](https://posit-conf-2023.github.io/devops/coursework_labs/03_lab_data_in_prod/lab_solution.html#part-2-explore-your-api)\n\n![](images/Screenshot%202023-09-18%20at%208.05.26%20AM-02.png)\n\n## Lab Activity: Explore Plumber\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 3: Part 3](https://posit-conf-2023.github.io/devops/coursework_labs/03_lab_data_in_prod/lab_solution.html#part-3-plumber-examples)\n\n## Where is it deployed?\n\n![](images/slides.png)\n\n## Lab Activity: Push button deployment\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 3: Part 4](https://posit-conf-2023.github.io/devops/coursework_labs/03_lab_data_in_prod/lab_solution.html#part-4-push-button-deployment)\n\n## Lab Activity: Access API data\n\n<br>\n\nüü• - I need help\n\nüü© - I'm done\n\n<br>\n\n[Lab 3: Part 5](https://posit-conf-2023.github.io/devops/coursework_labs/03_lab_data_in_prod/lab_solution.html#part-5-programmatically-access-connect)\n\n## Thank you so much!!!!\n\n<iframe src=\"https://giphy.com/embed/3oriffa6h9StTOq6ly\" width=\"480\" height=\"364\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen>\n\n</iframe>\n",
    "supporting": [
      "workshop_full_slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}